\begin{tikzpicture}
\begin{axis}[
    width=0.9\textwidth,
	height=10cm,
	legend style={at={(0.02,0.98)}, anchor=north west, font=\small, cells={anchor=west}},
	axis x line=bottom,
	axis y line=left,
	cycle multi list={
		linestyles\nextlist
		blue,red,orange,green,cyan
	},
	%no markers,
	mark options={scale=0.5},
	every axis plot/.append style={thick},
    ymin=0,
    ymax=100,
    xmin=32768,
    xmax=1073741824,
	ylabel=Throughput (GiB/s),
	xlabel=Input Length,
	xmode=log,
	log basis x=2,
	y tick label style={%
		/pgf/number format/.cd,%
		scaled x ticks = false,%
		set thousands separator={},%
		fixed%
	},
	xticklabels={32 KiB,64 KiB,128 KiB,256 KiB,512 KiB,1 MiB,2 MiB,4 MiB,8 MiB,16 MiB,32 MiB,64 MiB,128 MiB,256 MiB,512 MiB,1 GiB},
	xtick={32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824},
	x tick label style={rotate=90,anchor=east}
]
\legend{48 threads,32 threads,16 threads,8 threads,4 threads,2 threads,1 thread}
% threads_48
\addplot coordinates {
(32768, 2.887027968482478)
(65536, 4.071455979594155)
(131072, 6.528819781738289)
(262144, 10.513502207359979)
(524288, 17.394757194898673)
(1048576, 27.430977269670468)
(2097152, 40.605907967720675)
(4194304, 57.23719684917102)
(8388608, 71.49745198426369)
(16777216, 88.43340036974317)
(33554432, 96.91074384165438)
(67108864, 93.0809238665907)
(134217728, 89.03923134997731)
(268435456, 88.68239270785789)
(536870912, 89.30977250246572)
(1073741824, 89.32288760218576)
};
% threads_32
\addplot coordinates {
(32768, 3.8734902265344564)
(65536, 5.869527452900506)
(131072, 9.03469820524766)
(262144, 14.759262437473932)
(524288, 23.43064282274582)
(1048576, 33.89170167295339)
(2097152, 47.45466230184613)
(4194304, 61.8180083018402)
(8388608, 77.63156189285043)
(16777216, 89.64899373144745)
(33554432, 93.59169396453068)
(67108864, 85.24647777400084)
(134217728, 78.85868696498126)
(268435456, 77.92419800960157)
(536870912, 77.86955485200878)
(1073741824, 78.26540078562837)
};
% threads_16
\addplot coordinates {
(32768, 5.361086229899734)
(65536, 8.714329052489145)
(131072, 13.77468767301237)
(262144, 20.582716544748095)
(524288, 29.883337215934553)
(1048576, 39.128401240913036)
(2097152, 50.01581572192307)
(4194304, 58.84215102342774)
(8388608, 66.07408040430856)
(16777216, 70.22537828011971)
(33554432, 72.44299230672223)
(67108864, 58.88645276186061)
(134217728, 54.29159516716906)
(268435456, 53.15674304363236)
(536870912, 52.68269837826563)
(1073741824, 51.792352716152855)
};
% threads_08
\addplot coordinates {
(32768, 6.717451391246451)
(65536, 10.269888841196435)
(131072, 14.356475752047873)
(262144, 18.98395417446593)
(524288, 25.25483454900287)
(1048576, 30.47555605437972)
(2097152, 33.861316317840114)
(4194304, 36.02230437063406)
(8388608, 37.66848550769804)
(16777216, 38.78348673260553)
(33554432, 37.18342582425126)
(67108864, 30.46166146497173)
(134217728, 28.217924832976998)
(268435456, 27.471751223695524)
(536870912, 26.441196658801605)
(1073741824, 25.034595606294772)
};
% threads_04
\addplot coordinates {
(32768, 7.586757745178237)
(65536, 10.475700845877443)
(131072, 12.906672489264153)
(262144, 15.827964135793277)
(524288, 18.457251468815976)
(1048576, 20.099323091341002)
(2097152, 20.08160341331945)
(4194304, 20.207696083351)
(8388608, 20.75693770021205)
(16777216, 21.0118307300413)
(33554432, 19.10377073874376)
(67108864, 15.996760584144885)
(134217728, 14.81055786406246)
(268435456, 13.882877495452354)
(536870912, 12.959815946700441)
(1073741824, 12.425577137656836)
};
% threads_02
\addplot coordinates {
(32768, 7.913858698146113)
(65536, 9.65148224915338)
(131072, 10.861641759231814)
(262144, 11.60250618313749)
(524288, 11.954477397808196)
(1048576, 12.167835929647827)
(2097152, 11.69789307004965)
(4194304, 10.791957729983883)
(8388608, 11.155465218040767)
(16777216, 11.104563817755597)
(33554432, 10.402082025595815)
(67108864, 8.805432689093701)
(134217728, 7.808860246304982)
(268435456, 7.177518496203779)
(536870912, 6.9091992262389565)
(1073741824, 6.781625476884904)
};
% threads_01
\addplot coordinates {
(32768, 6.1843242451207106)
(65536, 6.151595515127176)
(131072, 6.220617561379796)
(262144, 6.2541492627479025)
(524288, 6.250371042276127)
(1048576, 5.810744011932857)
(2097152, 5.554140851358214)
(4194304, 5.444389445236837)
(8388608, 5.603722023882172)
(16777216, 5.602913915758918)
(33554432, 5.203544788013157)
(67108864, 4.303747663922745)
(134217728, 4.01864957824464)
(268435456, 3.8607512936406607)
(536870912, 3.818848296625481)
(1073741824, 3.770164351726395)
};
\end{axis}
\end{tikzpicture}
